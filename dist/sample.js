!function(){function t(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,n)}return s}function e(e){for(var n=1;n<arguments.length;n++){var i=null!=arguments[n]?arguments[n]:{};n%2?t(Object(i),!0).forEach((function(t){s(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):t(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function s(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}function n(t,e){for(var s=0;s<e.length;s++){var n=e[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var i,r,a={};let o=0;class c{constructor(t,e,s,n={}){if("string"!=typeof t)throw new TypeError("Gestures require a string type / name");this.type=t,this.id=`gesture-${this.type}-${o++}`,this.element=e,this.handler=s,this.options={...c.DEFAULTS,...n}}isEnabled(t){const e=t.active.length,s=t.event,{enableKeys:n,disableKeys:i,minInputs:r,maxInputs:a}=this.options;return r<=e&&a>=e&&(0===n.length||n.some(t=>s[t]))&&!i.some(t=>s[t])}start(){return null}move(){return null}end(){return null}cancel(){return null}evaluateHook(t,e){const s=this[t](e);s&&this.recognize(t,e,s)}recognize(t,e,s){this.handler({centroid:e.centroid,event:e.event,phase:t,type:this.type,target:this.element,...s})}}c.DEFAULTS={enableKeys:[],disableKeys:[],minInputs:1,maxInputs:Number.MAX_VALUE},r=c;var u={},h={},l={};class d{constructor(t=0,e=0){this.x=t,this.y=e}angleTo(t){return Math.atan2(t.y-this.y,t.x-this.x)}averageDistanceTo(t){return this.totalDistanceTo(t)/t.length}clone(){return new d(this.x,this.y)}distanceTo(t){return Math.hypot(t.x-this.x,t.y-this.y)}minus(t){return new d(this.x-t.x,this.y-t.y)}plus(t){return new d(this.x+t.x,this.y+t.y)}totalDistanceTo(t){return t.reduce((t,e)=>t+this.distanceTo(e),0)}static centroid(t=[]){if(0===t.length)return null;const e=d.sum(t);return e.x/=t.length,e.y/=t.length,e}static sum(t=[]){return t.reduce((t,e)=>(t.x+=e.x,t.y+=e.y,t),new d(0,0))}}l=d;var p;const v="cancel",m="end",y="move",f="start";p={CANCEL_EVENTS:["blur","pointercancel","touchcancel","mouseleave"],KEYBOARD_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup"],POINTER_EVENTS:["pointerdown","pointermove","pointerup"],TOUCH_EVENTS:["touchend","touchmove","touchstart"],STATE_KEYS:["altKey","ctrlKey","metaKey","shiftKey"],STATE_KEY_STRINGS:["Alt","Control","Meta","Shift"],CANCEL:v,END:m,MOVE:y,START:f,PHASE:{blur:v,pointercancel:v,touchcancel:v,mouseup:m,pointerup:m,touchend:m,mousemove:y,pointermove:y,touchmove:y,mousedown:f,pointerdown:f,touchstart:f}};const{PHASE:g}=p;h=class{constructor(t,e){const{clientX:s,clientY:n}=function(t,e){return t.changedTouches?Array.from(t.changedTouches).find(t=>t.identifier===e):t}(t,e);this.event=t,this.type=g[t.type],this.time=Date.now(),this.point=new l(s,n)}};var E;const w=2*Math.PI,T=-Math.PI;function P(t,e){const s=new Set;return t.forEach(t=>{e(t)&&s.add(t)}),s}E={angularDifference:function(t,e){let s=t-e;return s<T?s+=w:s>Math.PI&&(s-=w),s},getPropagationPath:function(t){if("function"==typeof t.composedPath)return t.composedPath();const e=[];for(let s=t.target;s!==document;s=s.parentNode)e.push(s);return e.push(document),e.push(window),e},setDifference:function(t,e){return P(t,t=>!e.has(t))},setFilter:P};const{getPropagationPath:S}=E;u=class{constructor(t,e){const s=new h(t,e);this.initialElements=new WeakSet(S(t)),this.initial=s,this.current=s,this.previous=s,this.identifier=e}get phase(){return this.current.type}get startTime(){return this.initial.time}totalDistance(){return this.initial.point.distanceTo(this.current.point)}update(t){this.previous=this.current,this.current=new h(t,this.identifier)}};var b,A={};const{CANCEL:D,END:G,MOVE:x,PHASE:k,START:I}=p,O=Symbol.for("inputs"),L={TouchEvent:function(t){Array.from(t.changedTouches).forEach(e=>{this.updateInput(t,e.identifier)})},PointerEvent:function(t){this.updateInput(t,t.pointerId)},MouseEvent:function(t){0===t.button&&this.updateInput(t,t.button)}};A=class{constructor(t){this.element=t,this[O]=new Map,this.inputs=[],this.active=[],this.activePoints=[],this.centroid={},this.event=null}clearEndedInputs(){this[O].forEach((t,e)=>{"end"===t.phase&&this[O].delete(e)})}getInputsInPhase(t){return this.inputs.filter(e=>e.phase===t)}getInputsNotInPhase(t){return this.inputs.filter(e=>e.phase!==t)}hasNoInputs(){return 0===this[O].size}updateInput(t,e){switch(k[t.type]){case I:this[O].set(e,new u(t,e));try{this.element.setPointerCapture(e)}catch(t){}break;case G:try{this.element.releasePointerCapture(e)}catch(t){}case D:case x:this[O].has(e)&&this[O].get(e).update(t);break;default:console.warn("Unrecognized event type: "+t.type)}}updateAllInputs(t){L[t.constructor.name].call(this,t),this.updateFields(t)}updateFields(t){this.inputs=Array.from(this[O].values()),this.active=this.getInputsNotInPhase("end"),this.activePoints=this.active.map(t=>t.current.point),this.centroid=l.centroid(this.activePoints),this.event=t}};const{CANCEL_EVENTS:C,KEYBOARD_EVENTS:N,MOUSE_EVENTS:R,POINTER_EVENTS:F,TOUCH_EVENTS:U,STATE_KEY_STRINGS:M,PHASE:_,CANCEL:j,END:K,START:z}=p,{setDifference:V,setFilter:H}=E;class Y{constructor(t=window,e={}){e={...Y.DEFAULTS,...e},this.gestures=new Set,this.activeGestures=new Set,this.potentialGestures=new Set,this.element=t,this.options=e,this.state=new A(this.element),this.activate()}activate(){let t=[];t=this.options.preferPointer&&window.PointerEvent?F:R.concat(U);const e=this.arbitrate.bind(this);t.forEach(t=>{this.element.addEventListener(t,e,{capture:this.options.capture,once:!1,passive:!1})});const s=this.cancel.bind(this);C.forEach(t=>{window.addEventListener(t,s)});const n=this.handleKeyboardEvent.bind(this);N.forEach(t=>{window.addEventListener(t,n)})}cancel(t){this.options.preventDefault&&t.preventDefault(),this.state.inputs.forEach(e=>{e.update(t)}),this.activeGestures.forEach(t=>{t.evaluateHook(j,this.state)}),this.state=new A(this.element),this.resetActiveGestures()}handleKeyboardEvent(t){if(M.indexOf(t.key)>=0){this.state.event=t;const e=this.activeGestures;this.setActiveGestures(),V(e,this.activeGestures).forEach(t=>{t.evaluateHook(K,this.state)}),V(this.activeGestures,e).forEach(t=>{t.evaluateHook(z,this.state)})}}resetActiveGestures(){this.potentialGestures=new Set,this.activeGestures=new Set}setActiveGestures(){this.activeGestures=H(this.potentialGestures,t=>t.isEnabled(this.state))}setPotentialGestures(){const t=this.state.inputs[0];this.potentialGestures=H(this.gestures,e=>t.initialElements.has(e.element))}updateActiveGestures(t,e){_[t.type]===z&&(e&&this.setPotentialGestures(),this.setActiveGestures())}pruneActiveGestures(t){_[t.type]===K&&(this.state.hasNoInputs()?this.resetActiveGestures():this.setActiveGestures())}arbitrate(t){const e=this.state.hasNoInputs();this.state.updateAllInputs(t),this.updateActiveGestures(t,e),this.activeGestures.size>0&&(this.options.preventDefault&&t.preventDefault(),this.activeGestures.forEach(e=>{e.evaluateHook(_[t.type],this.state)})),this.state.clearEndedInputs(),this.pruneActiveGestures(t)}addGesture(t){t.element.style.touchAction=this.options.touchAction,this.gestures.add(t)}removeGesture(t){this.gestures.delete(t),this.potentialGestures.delete(t),this.activeGestures.delete(t)}getGesturesByElement(t){return H(this.gestures,e=>e.element===t)}removeGesturesByElement(t){this.getGesturesByElement(t).forEach(t=>this.removeGesture(t))}}Y.DEFAULTS={capture:!1,preferPointer:!0,preventDefault:!0,touchAction:"none"},b=Y;const B=Symbol("cascade"),X=Symbol("smooth");class W{constructor(t={}){const e={...W.DEFAULTS,...t};this.next=null,!function(t){if(t)try{return window.matchMedia("(pointer: coarse)").matches}catch(t){return!0}return!1}(e.applySmoothing)?this.next=t=>t:this.next=this[X].bind(this),this.identity=e.identity,this[B]=this.identity}restart(){this[B]=this.identity}[X](t){const e=this.average(this[B],t);return this[B]=e,e}average(t,e){return(t+e)/2}}W.DEFAULTS={applySmoothing:!0,identity:0},i={Gesture:r,Input:u,Point2D:l,PointerData:h,Region:b,Smoothable:W,State:A,...p,...E};var q;const{Gesture:$,Point2D:J,Smoothable:Q}=i;q=class extends ${constructor(t,e,s={}){super("pan",t,e,s),this.previous=null,this.outgoing=new Q({...s,identity:new J}),this.outgoing.average=(t,e)=>J.centroid([t,e])}restart(t){this.previous=t.centroid,this.outgoing.restart()}start(t){this.restart(t)}move(t){const e=t.centroid.minus(this.previous);return this.previous=t.centroid,{translation:this.outgoing.next(e)}}end(t){this.restart(t)}cancel(t){this.restart(t)}};var Z;const{Gesture:tt,Smoothable:et}=i;class st extends tt{constructor(t,e,s={}){super("pinch",t,e,s={...st.DEFAULTS,...s}),this.previous=0,this.outgoing=new et({...s,identity:1})}restart(t){this.previous=t.centroid.averageDistanceTo(t.activePoints),this.outgoing.restart()}start(t){this.restart(t)}move(t){const e=t.centroid.averageDistanceTo(t.activePoints),s=e/this.previous;return this.previous=e,{distance:e,scale:this.outgoing.next(s)}}end(t){this.restart(t)}cancel(t){this.restart(t)}}st.DEFAULTS=Object.freeze({minInputs:2}),Z=st;var nt;const{Gesture:it,Point2D:rt,MOVE:at}=i;class ot extends it{constructor(t,e,s={}){super("press",t,e,s={...ot.DEFAULTS,...s}),this.delay=s.delay,this.tolerance=s.tolerance}start(t){const e=t.centroid,s=Array.from(t.active);setTimeout(()=>{const n=t.active.filter(t=>s.includes(t));if(n.length===s.length){const s=rt.centroid(n.map(t=>t.current.point)),i=e.distanceTo(s);i<=this.tolerance&&this.recognize(at,t,{centroid:s,distance:i,initial:e})}},this.delay)}}ot.DEFAULTS=Object.freeze({delay:1e3,tolerance:10}),nt=ot;var ct;const{Smoothable:ut}=i;var ht;const{Gesture:lt,Point2D:dt,Smoothable:pt}=i;function vt(t){const e=t.getBoundingClientRect();return new dt(e.left+e.width/2,e.top+e.height/2)}class mt extends lt{constructor(t="pivotable",e,s,n={}){super(t,e,s,n),n={...mt.DEFAULTS,...n},this.deadzoneRadius=n.deadzoneRadius,this.dynamicPivot=n.dynamicPivot,this.pivot=null,this.previous=0,this.outgoing=new pt(n)}updatePrevious(){throw"Gestures which extend Pivotable must implement updatePrevious()"}restart(t){this.dynamicPivot?(this.pivot=t.centroid,this.previous=0):(this.pivot=vt(this.element),this.updatePrevious(t)),this.outgoing.restart()}start(t){this.restart(t)}end(t){t.active.length>0?this.restart(t):this.outgoing.restart()}cancel(){this.outgoing.restart()}}mt.DEFAULTS=Object.freeze({deadzoneRadius:15,dynamicPivot:!1}),mt.getClientCenter=vt,ht=mt;ct=class extends ht{constructor(t,e,s={}){super("pull",t,e,s),this.outgoing=new ut({...s,identity:1})}updatePrevious(t){this.previous=this.pivot.distanceTo(t.centroid)}move(t){const e=this.pivot,s=e.distanceTo(t.centroid),n=s/this.previous;let i=null;return s>this.deadzoneRadius&&this.previous>this.deadzoneRadius&&(i={distance:s,scale:this.outgoing.next(n),pivot:e}),this.previous=s,i}};var yt;const{angularDifference:ft,Gesture:gt,Smoothable:Et}=i;class wt extends gt{constructor(t,e,s={}){super("rotate",t,e,s={...wt.DEFAULTS,...s}),this.previousAngles=[],this.outgoing=new Et(s)}anglesFromCentroid(t){return t.active.map(e=>t.centroid.angleTo(e.current.point))}getRotation(t){const e=this.anglesFromCentroid(t),s=e.reduce((t,e,s)=>t+ft(e,this.previousAngles[s]),0);return this.previousAngles=e,s/t.active.length}restart(t){this.previousAngles=this.anglesFromCentroid(t),this.outgoing.restart()}start(t){this.restart(t)}move(t){const e=this.getRotation(t);return e?{rotation:this.outgoing.next(e)}:null}end(t){this.restart(t)}cancel(){this.outgoing.restart()}}wt.DEFAULTS=Object.freeze({minInputs:2}),yt=wt;var Tt;const{Gesture:Pt}=i;Tt=class extends Pt{constructor(t,e,s={}){super("swipe",t,e,s),this.moves=[],this.saved=null}restart(){this.moves=[],this.saved=null}start(){this.restart()}move(t){this.moves.push({time:Date.now(),point:t.centroid}),this.moves.length>7&&this.moves.splice(0,this.moves.length-7)}end(t){const e=this.getResult();return this.moves=[],t.active.length>0?(this.saved=e,null):(this.saved=null,this.validate(e))}cancel(){this.restart()}getResult(){if(this.moves.length<7)return this.saved;const{point:t,time:e}=this.moves[6];return{point:t,velocity:function(t,e){let s=0;for(let r=0;r<e;++r){const e=(n=t[r],(i=t[r+1]).point.distanceTo(n.point)/(i.time-n.time+1));e>s&&(s=e)}var n,i;return s}(this.moves,6),direction:function(t,e){const s=t[e].point;let n=0,i=0;for(let r=0;r<e;++r){const e=t[r].point.angleTo(s);n+=Math.sin(e),i+=Math.cos(e)}return n/=e,i/=e,Math.atan2(n,i)}(this.moves,6),time:e,centroid:t}}validate(t){return null==t||Date.now()-t.time>300?null:t}};var St;const{angularDifference:bt,Smoothable:At}=i;St=class extends ht{constructor(t,e,s={}){super("swivel",t,e,s),this.outgoing=new At(s)}updatePrevious(t){this.previous=this.pivot.angleTo(t.centroid)}move(t){const e=this.pivot,s=e.angleTo(t.centroid),n=bt(s,this.previous);let i=null;return e.distanceTo(t.centroid)>this.deadzoneRadius&&(i={rotation:this.outgoing.next(n),pivot:e}),this.previous=s,i}};var Dt;const{Gesture:Gt,Point2D:xt}=i;class kt extends Gt{constructor(t,e,s={}){super("tap",t,e,s={...kt.DEFAULTS,...s}),this.minDelay=s.minDelay,this.maxDelay=s.maxDelay,this.numTaps=s.numTaps,this.tolerance=s.tolerance,this.taps=[]}end(t){const e=Date.now();if(this.taps=this.taps.concat(t.getInputsInPhase("end")).filter(t=>{const s=e-t.startTime;return s<=this.maxDelay&&s>=this.minDelay}),this.taps.length!==this.numTaps||this.taps.some(t=>t.totalDistance()>this.tolerance))return null;const s=xt.centroid(this.taps.map(t=>t.current.point));return this.taps=[],{centroid:s,...s}}}kt.DEFAULTS=Object.freeze({minDelay:0,maxDelay:300,numTaps:1,tolerance:10}),Dt=kt;const{Gesture:It}=i;class Ot extends It{constructor(t,e,s={}){super("track",t,e,s={...Ot.DEFAULTS,...s}),this.trackStart=s.phases.includes("start"),this.trackMove=s.phases.includes("move"),this.trackEnd=s.phases.includes("end"),this.trackCancel=s.phases.includes("cancel")}data({activePoints:t}){return{active:t}}start(t){return this.trackStart?this.data(t):null}move(t){return this.trackMove?this.data(t):null}end(t){return this.trackEnd?this.data(t):null}cancel(t){return this.trackCancel?this.data(t):null}}Ot.DEFAULTS=Object.freeze({phases:Object.freeze([])});var Lt=new(a={Pan:q,Pinch:Z,Press:nt,Pull:ct,Rotate:yt,Swipe:Tt,Swivel:St,Tap:Dt,Track:Ot,...i}).Region,Ct=document.querySelector("#container");function Nt(){return Math.floor(256*Math.random())}function Rt(t){return t*=.95,Math.abs(t)<.1?0:t}for(var Ft=function(){function t(e,s){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.element=document.createElement("div"),this.element.style.backgroundColor=s,this.label=document.createElement("h1"),this.label.innerText=e,this.element.appendChild(this.label),Ct.appendChild(this.element),this.rotation=0,this.scale=1,this.x=0,this.y=0,this.velocityX=0,this.velocityY=0,this.animate=!1,this.update_fn=this.update.bind(this),this.swipe_interval=null,this.swipe_fn=this.swipeAnimation.bind(this),this.setupTracking()}var s,i,r;return s=t,(i=[{key:"setupTracking",value:function(){var t=this,e={end:function(e){0==e.active.length&&(t.animate=!1)},start:function(){t.animate=!0,window.requestAnimationFrame(t.update_fn),clearInterval(t.swipe_interval)}};Lt.addGesture(new a.Track(this.element,(function(t){return e[t.phase](t)}),{phases:Object.keys(e)}))}},{key:"randomBackground",value:function(){var t=Nt(),e=Nt(),s=Nt();this.element.style.backgroundColor="rgb(".concat(t,", ").concat(e,", ").concat(s,")")}},{key:"addTap",value:function(t){var e=this;return Lt.addGesture(new a.Tap(this.element,(function(){e.randomBackground()}),t)),this}},{key:"addPress",value:function(t){var e=this;return Lt.addGesture(new a.Press(this.element,(function(){e.randomBackground()}),t)),this}},{key:"addRotate",value:function(t){var e=this;return Lt.addGesture(new a.Rotate(this.element,(function(t){e.rotation+=t.rotation}),t)),this}},{key:"addPan",value:function(t){var e=this;return Lt.addGesture(new a.Pan(this.element,(function(t){e.x+=t.translation.x,e.y+=t.translation.y}),t)),this}},{key:"addSwipe",value:function(t){var e=this;return Lt.addGesture(new a.Swipe(this.element,(function(t){var s=t.velocity>7?7:t.velocity;e.velocityX=s*Math.cos(t.direction)*7,e.velocityY=s*Math.sin(t.direction)*7,e.swipe_interval=setInterval(e.swipe_fn,16.666666666666668)}),t)),this}},{key:"addSwivel",value:function(t){var s=this;return Lt.addGesture(new a.Swivel(this.element,(function(t){s.rotation+=t.rotation}),e({pivotCenter:this.element},t))),this}},{key:"addPinch",value:function(t){var e=this;return Lt.addGesture(new a.Pinch(this.element,(function(t){e.scale*=t.scale}),t)),this}},{key:"addPull",value:function(t){var s=this;return Lt.addGesture(new a.Pull(this.element,(function(t){s.scale*=t.scale}),e({pivotCenter:this.element},t))),this}},{key:"update",value:function(){var t="rotate(".concat(this.rotation,"rad) "),e="translate(".concat(this.x,"px, ").concat(this.y,"px) "),s="scale(".concat(this.scale,") ");this.element.style.transform=e+t+s,this.animate&&window.requestAnimationFrame(this.update_fn)}},{key:"swipeAnimation",value:function(){this.x+=this.velocityX,this.y+=this.velocityY,this.velocityX=Rt(this.velocityX),this.velocityY=Rt(this.velocityY),0===this.velocityY&&0===this.velocityX&&clearInterval(this.swipe_interval),window.requestAnimationFrame(this.update_fn)}}])&&n(s.prototype,i),r&&n(s,r),t}(),Ut=Math.floor(30),Mt=[],_t=0;_t<12;_t++){var jt=Ut*_t;Mt.push("hsl(".concat(jt,", 100%, 75%)"))}var Kt=0;function zt(){return Mt[Kt++]}new Ft("TAP",zt()).addTap(),new Ft("PAN",zt()).addPan(),new Ft("PINCH",zt()).addPinch(),new Ft("ROTATE",zt()).addRotate(),new Ft("SWIPE",zt()).addSwipe(),new Ft("PRESS",zt()).addPress(),new Ft("SWIVEL",zt()).addSwivel(),new Ft("PULL",zt()).addPull(),new Ft("TAP, PAN, PINCH, SWIPE, and ROTATE\n(desktop: CTRL to SWIVEL and PULL)",zt()).addTap().addPan({disableKeys:["ctrlKey"]}).addPinch().addRotate().addSwipe().addSwivel({enableKeys:["ctrlKey"]}).addPull({enableKeys:["ctrlKey"]}),new Ft("DOUBLE TAP",zt()).addTap({numTaps:2}),new Ft("FIVE TAPS",zt()).addTap({maxDelay:1e3,numTaps:5}),new Ft("SLOW TAP",zt()).addTap({minDelay:300,maxDelay:1e3})}();
//# sourceMappingURL=sample.js.map
