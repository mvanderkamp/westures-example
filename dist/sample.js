!function(){function t(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,n)}return s}function e(e){for(var n=1;n<arguments.length;n++){var i=null!=arguments[n]?arguments[n]:{};n%2?t(Object(i),!0).forEach((function(t){s(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):t(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function s(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}function n(t,e){for(var s=0;s<e.length;s++){var n=e[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var i,r,a={};let o=0;class c{constructor(t,e,s,n={}){if("string"!=typeof t)throw new TypeError("Gestures require a string type / name");this.type=t,this.id=`gesture-${this.type}-${o++}`,this.element=e,this.handler=s,this.options={...c.DEFAULTS,...n}}isEnabled(t){const e=t.active.length,s=t.event,{enableKeys:n,disableKeys:i,minInputs:r,maxInputs:a}=this.options;return r<=e&&a>=e&&(0===n.length||n.some(t=>s[t]))&&!i.some(t=>s[t])}start(){return null}move(){return null}end(){return null}cancel(){return null}evaluateHook(t,e){const s=this[t](e);s&&this.recognize(t,e,s)}recognize(t,e,s){this.handler({centroid:e.centroid,event:e.event,phase:t,type:this.type,target:this.element,...s})}}c.DEFAULTS=Object.freeze({enableKeys:[],disableKeys:[],minInputs:1,maxInputs:Number.MAX_VALUE}),r=c;var u={},h={},l={};class d{constructor(t=0,e=0){this.x=t,this.y=e}angleTo(t){return Math.atan2(t.y-this.y,t.x-this.x)}averageDistanceTo(t){return this.totalDistanceTo(t)/t.length}clone(){return new d(this.x,this.y)}distanceTo(t){return Math.hypot(t.x-this.x,t.y-this.y)}minus(t){return new d(this.x-t.x,this.y-t.y)}plus(t){return new d(this.x+t.x,this.y+t.y)}totalDistanceTo(t){return t.reduce((t,e)=>t+this.distanceTo(e),0)}static centroid(t=[]){if(0===t.length)return null;const e=d.sum(t);return e.x/=t.length,e.y/=t.length,e}static sum(t=[]){return t.reduce((t,e)=>(t.x+=e.x,t.y+=e.y,t),new d(0,0))}}l=d;var p;p={CANCEL_EVENTS:Object.freeze(["blur","pointercancel","touchcancel"]),KEYBOARD_EVENTS:Object.freeze(["keydown","keyup"]),MOUSE_EVENTS:Object.freeze(["mousedown","mousemove","mouseup"]),POINTER_EVENTS:Object.freeze(["pointerdown","pointermove","pointerup"]),TOUCH_EVENTS:Object.freeze(["touchend","touchmove","touchstart"]),STATE_KEYS:Object.freeze(["altKey","ctrlKey","metaKey","shiftKey"]),STATE_KEY_STRINGS:Object.freeze(["Alt","Control","Meta","Shift"]),CANCEL:"cancel",END:"end",MOVE:"move",START:"start",PHASE:Object.freeze({blur:"cancel",pointercancel:"cancel",touchcancel:"cancel",mouseup:"end",pointerup:"end",touchend:"end",mousemove:"move",pointermove:"move",touchmove:"move",mousedown:"start",pointerdown:"start",touchstart:"start"})};const{PHASE:v}=p;h=class{constructor(t,e){const{clientX:s,clientY:n}=function(t,e){return t.changedTouches?Array.from(t.changedTouches).find(t=>t.identifier===e):t}(t,e);this.event=t,this.type=v[t.type],this.time=Date.now(),this.point=new l(s,n)}};var m;const f=2*Math.PI,y=-Math.PI;function g(t,e){const s=new Set;return t.forEach(t=>{e(t)&&s.add(t)}),s}m=Object.freeze({angularDifference:function(t,e){let s=t-e;return s<y?s+=f:s>Math.PI&&(s-=f),s},getPropagationPath:function(t){if("function"==typeof t.composedPath)return t.composedPath();const e=[];for(let s=t.target;s!==document;s=s.parentNode)e.push(s);return e.push(document),e.push(window),e},setDifference:function(t,e){return g(t,t=>!e.has(t))},setFilter:g});const{getPropagationPath:w}=m;u=class{constructor(t,e){const s=new h(t,e);this.initialElements=new WeakSet(w(t)),this.initial=s,this.current=s,this.previous=s,this.identifier=e}get phase(){return this.current.type}get startTime(){return this.initial.time}totalDistance(){return this.initial.point.distanceTo(this.current.point)}update(t){this.previous=this.current,this.current=new h(t,this.identifier)}};var E,T={};const{CANCEL:b,END:S,MOVE:P,PHASE:A,START:D}=p,G=Object.freeze({inputs:Symbol.for("inputs")}),O={TouchEvent:function(t){Array.from(t.changedTouches).forEach(e=>{this.updateInput(t,e.identifier)})},PointerEvent:function(t){this.updateInput(t,t.pointerId)},MouseEvent:function(t){0===t.button&&this.updateInput(t,t.button)}};T=class{constructor(t){this.element=t,this[G.inputs]=new Map,this.inputs=[],this.active=[],this.activePoints=[],this.centroid={},this.event=null}clearEndedInputs(){this[G.inputs].forEach((t,e)=>{"end"===t.phase&&this[G.inputs].delete(e)})}getInputsInPhase(t){return this.inputs.filter(e=>e.phase===t)}getInputsNotInPhase(t){return this.inputs.filter(e=>e.phase!==t)}hasNoInputs(){return 0===this[G.inputs].size}updateInput(t,e){switch(A[t.type]){case D:this[G.inputs].set(e,new u(t,e));try{this.element.setPointerCapture(e)}catch(t){}break;case S:try{this.element.releasePointerCapture(e)}catch(t){}case b:case P:this[G.inputs].has(e)&&this[G.inputs].get(e).update(t);break;default:console.warn("Unrecognized event type: "+t.type)}}updateAllInputs(t){O[t.constructor.name].call(this,t),this.updateFields(t)}updateFields(t){this.inputs=Array.from(this[G.inputs].values()),this.active=this.getInputsNotInPhase("end"),this.activePoints=this.active.map(t=>t.current.point),this.centroid=l.centroid(this.activePoints),this.event=t}};const{CANCEL_EVENTS:x,KEYBOARD_EVENTS:k,MOUSE_EVENTS:I,POINTER_EVENTS:L,TOUCH_EVENTS:j,STATE_KEY_STRINGS:z,PHASE:C,CANCEL:N,END:R,START:F}=p,{setDifference:M,setFilter:U}=m;class _{constructor(t,e={}){const s={..._.DEFAULTS,...e};this.gestures=new Set,this.activeGestures=new Set,this.potentialGestures=new Set,this.element=t,this.capture=s.capture,this.preventDefault=s.preventDefault,this.state=new T(this.element),this.activate()}activate(){let t=[];t=window.TouchEvent||window.MouseEvent?I.concat(j):L;const e=this.arbitrate.bind(this);t.forEach(t=>{this.element.addEventListener(t,e,{capture:this.capture,once:!1,passive:!1})});const s=this.cancel.bind(this);x.forEach(t=>{window.addEventListener(t,s)});const n=this.handleKeyboardEvent.bind(this);k.forEach(t=>{window.addEventListener(t,n)})}cancel(t){t.preventDefault(),this.state.inputs.forEach(e=>{e.update(t)}),this.activeGestures.forEach(t=>{t.evaluateHook(N,this.state)}),this.state=new T(this.element),this.resetActiveGestures()}handleKeyboardEvent(t){if(z.indexOf(t.key)>=0){this.state.event=t;const e=this.activeGestures;this.setActiveGestures(),M(e,this.activeGestures).forEach(t=>{t.evaluateHook(R,this.state)}),M(this.activeGestures,e).forEach(t=>{t.evaluateHook(F,this.state)})}}resetActiveGestures(){this.potentialGestures=new Set,this.activeGestures=new Set}setActiveGestures(){this.activeGestures=U(this.potentialGestures,t=>t.isEnabled(this.state))}setPotentialGestures(){const t=this.state.inputs[0];this.potentialGestures=U(this.gestures,e=>t.initialElements.has(e.element))}updateActiveGestures(t,e){C[t.type]===F&&(e&&this.setPotentialGestures(),this.setActiveGestures())}pruneActiveGestures(t){C[t.type]===R&&(this.state.hasNoInputs()?this.resetActiveGestures():this.setActiveGestures())}arbitrate(t){const e=this.state.hasNoInputs();this.state.updateAllInputs(t),this.updateActiveGestures(t,e),this.activeGestures.size>0&&(this.preventDefault&&t.preventDefault(),this.activeGestures.forEach(e=>{e.evaluateHook(C[t.type],this.state)})),this.state.clearEndedInputs(),this.pruneActiveGestures(t)}addGesture(t){this.gestures.add(t)}removeGesture(t){this.gestures.delete(t),this.potentialGestures.delete(t),this.activeGestures.delete(t)}getGesturesByElement(t){return U(this.gestures,e=>e.element===t)}removeGesturesByElement(t){this.getGesturesByElement(t).forEach(t=>this.removeGesture(t))}}_.DEFAULTS=Object.freeze({capture:!1,preventDefault:!0}),E=_;const K=Symbol("cascade"),V=Symbol("smooth");class H{constructor(t={}){const e={...H.DEFAULTS,...t};this.next=null,!function(t){if(t)try{return window.matchMedia("(pointer: coarse)").matches}catch(t){return!0}return!1}(e.applySmoothing)?this.next=t=>t:this.next=this[V].bind(this),this.identity=e.identity,this[K]=this.identity}restart(){this[K]=this.identity}[V](t){const e=this.average(this[K],t);return this[K]=e,e}average(t,e){return(t+e)/2}}H.DEFAULTS=Object.freeze({applySmoothing:!0,identity:0}),i={Gesture:r,Input:u,Point2D:l,PointerData:h,Region:E,Smoothable:H,State:T,...p,...m};var Y;const{Gesture:B,Point2D:X,Smoothable:W}=i;Y=class extends B{constructor(t,e,s={}){super("pan",t,e,s),this.previous=null,this.outgoing=new W({...s,identity:new X}),this.outgoing.average=(t,e)=>X.centroid([t,e])}restart(t){this.previous=t.centroid,this.outgoing.restart()}start(t){this.restart(t)}move(t){const e=t.centroid.minus(this.previous);return this.previous=t.centroid,{translation:this.outgoing.next(e)}}end(t){this.restart(t)}cancel(t){this.restart(t)}};var q;const{Gesture:$,Smoothable:J}=i;class Q extends ${constructor(t,e,s={}){super("pinch",t,e,s={...Q.DEFAULTS,...s}),this.previous=0,this.outgoing=new J({...s,identity:1})}restart(t){this.previous=t.centroid.averageDistanceTo(t.activePoints),this.outgoing.restart()}start(t){this.restart(t)}move(t){const e=t.centroid.averageDistanceTo(t.activePoints),s=e/this.previous;return this.previous=e,{distance:e,scale:this.outgoing.next(s)}}end(t){this.restart(t)}cancel(t){this.restart(t)}}Q.DEFAULTS=Object.freeze({minInputs:2}),q=Q;var Z;const{Gesture:tt,Point2D:et,MOVE:st}=i;class nt extends tt{constructor(t,e,s={}){super("press",t,e,s={...nt.DEFAULTS,...s}),this.delay=s.delay,this.tolerance=s.tolerance}start(t){const e=t.centroid,s=new Set(t.active.map(t=>t.identifier));setTimeout(()=>{const n=t.active.filter(t=>s.has(t.identifier)),i=et.centroid(n.map(t=>t.current.point)),r=e.distanceTo(i);r<=this.tolerance&&n.length===s.size&&this.recognize(st,t,{centroid:i,distance:r,initial:e})},this.delay)}}nt.DEFAULTS=Object.freeze({delay:1e3,tolerance:10}),Z=nt;var it;const{Smoothable:rt}=i;var at;const{Gesture:ot,Point2D:ct,Smoothable:ut}=i;function ht(t){const e=t.getBoundingClientRect();return new ct(e.left+e.width/2,e.top+e.height/2)}class lt extends ot{constructor(t="pivotable",e,s,n={}){super(t,e,s,n),n={...lt.DEFAULTS,...n},this.deadzoneRadius=n.deadzoneRadius,this.dynamicPivot=n.dynamicPivot,this.pivot=null,this.previous=0,this.outgoing=new ut(n)}updatePrevious(){throw"Gestures which extend Pivotable must implement updatePrevious()"}restart(t){this.dynamicPivot?(this.pivot=t.centroid,this.previous=0):(this.pivot=ht(this.element),this.updatePrevious(t)),this.outgoing.restart()}start(t){this.restart(t)}end(t){t.active.length>0?this.restart(t):this.outgoing.restart()}cancel(){this.outgoing.restart()}}lt.DEFAULTS=Object.freeze({deadzoneRadius:15,dynamicPivot:!1}),lt.getClientCenter=ht,at=lt;it=class extends at{constructor(t,e,s={}){super("pull",t,e,s),this.outgoing=new rt({...s,identity:1})}updatePrevious(t){this.previous=this.pivot.distanceTo(t.centroid)}move(t){const e=this.pivot,s=e.distanceTo(t.centroid),n=s/this.previous;let i=null;return s>this.deadzoneRadius&&this.previous>this.deadzoneRadius&&(i={distance:s,scale:this.outgoing.next(n),pivot:e}),this.previous=s,i}};var dt;const{angularDifference:pt,Gesture:vt,Smoothable:mt}=i;class ft extends vt{constructor(t,e,s={}){super("rotate",t,e,s={...ft.DEFAULTS,...s}),this.previousAngles=[],this.outgoing=new mt(s)}anglesFromCentroid(t){return t.active.map(e=>t.centroid.angleTo(e.current.point))}getRotation(t){const e=this.anglesFromCentroid(t),s=e.reduce((t,e,s)=>t+pt(e,this.previousAngles[s]),0);return this.previousAngles=e,s/t.active.length}restart(t){this.previousAngles=this.anglesFromCentroid(t),this.outgoing.restart()}start(t){this.restart(t)}move(t){const e=this.getRotation(t);return e?{rotation:this.outgoing.next(e)}:null}end(t){this.restart(t)}cancel(){this.outgoing.restart()}}ft.DEFAULTS=Object.freeze({minInputs:2}),dt=ft;var yt;const{Gesture:gt}=i;yt=class extends gt{constructor(t,e,s={}){super("swipe",t,e,s),this.moves=[],this.saved=null}restart(){this.moves=[],this.saved=null}start(){this.restart()}move(t){this.moves.push({time:Date.now(),point:t.centroid}),this.moves.length>7&&this.moves.splice(0,this.moves.length-7)}end(t){const e=this.getResult();return this.moves=[],t.active.length>0?(this.saved=e,null):(this.saved=null,this.validate(e))}cancel(){this.restart()}getResult(){if(this.moves.length<7)return this.saved;const{point:t,time:e}=this.moves[6];return{point:t,velocity:function(t,e){let s=0;for(let r=0;r<e;++r){const e=(n=t[r],(i=t[r+1]).point.distanceTo(n.point)/(i.time-n.time+1));e>s&&(s=e)}var n,i;return s}(this.moves,6),direction:function(t,e){const s=t[e].point;let n=0,i=0;for(let r=0;r<e;++r){const e=t[r].point.angleTo(s);n+=Math.sin(e),i+=Math.cos(e)}return n/=e,i/=e,Math.atan2(n,i)}(this.moves,6),time:e,centroid:t}}validate(t){return null==t||Date.now()-t.time>300?null:t}};var wt;const{angularDifference:Et,Smoothable:Tt}=i;wt=class extends at{constructor(t,e,s={}){super("swivel",t,e,s),this.outgoing=new Tt(s)}updatePrevious(t){this.previous=this.pivot.angleTo(t.centroid)}move(t){const e=this.pivot,s=e.angleTo(t.centroid),n=Et(s,this.previous);let i=null;return e.distanceTo(t.centroid)>this.deadzoneRadius&&(i={rotation:this.outgoing.next(n),pivot:e}),this.previous=s,i}};var bt;const{Gesture:St,Point2D:Pt}=i;class At extends St{constructor(t,e,s={}){super("tap",t,e,s={...At.DEFAULTS,...s}),this.minDelay=s.minDelay,this.maxDelay=s.maxDelay,this.numTaps=s.numTaps,this.tolerance=s.tolerance,this.taps=[]}end(t){const e=Date.now();if(this.taps=this.taps.concat(t.getInputsInPhase("end")).filter(t=>{const s=e-t.startTime;return s<=this.maxDelay&&s>=this.minDelay}),this.taps.length!==this.numTaps||this.taps.some(t=>t.totalDistance()>this.tolerance))return null;const s=Pt.centroid(this.taps.map(t=>t.current.point));return this.taps=[],{centroid:s,...s}}}At.DEFAULTS=Object.freeze({minDelay:0,maxDelay:300,numTaps:1,tolerance:10}),bt=At;const{Gesture:Dt}=i;class Gt extends Dt{constructor(t,e,s={}){super("track",t,e,s={...Gt.DEFAULTS,...s}),this.trackStart=s.phases.includes("start"),this.trackMove=s.phases.includes("move"),this.trackEnd=s.phases.includes("end"),this.trackCancel=s.phases.includes("cancel")}data({activePoints:t}){return{active:t}}start(t){return this.trackStart?this.data(t):null}move(t){return this.trackMove?this.data(t):null}end(t){return this.trackEnd?this.data(t):null}cancel(t){return this.trackCancel?this.data(t):null}}Gt.DEFAULTS=Object.freeze({phases:Object.freeze([])});var Ot=new(a={Pan:Y,Pinch:q,Press:Z,Pull:it,Rotate:dt,Swipe:yt,Swivel:wt,Tap:bt,Track:Gt,...i}).Region(document.body),xt=document.querySelector("#container");function kt(){return Math.floor(256*Math.random())}function It(t){return t*=.95,Math.abs(t)<.1?0:t}for(var Lt=function(){function t(e,s){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.element=document.createElement("div"),this.element.style.backgroundColor=s,this.label=document.createElement("h1"),this.label.innerText=e,this.element.appendChild(this.label),xt.appendChild(this.element),this.rotation=0,this.scale=1,this.x=0,this.y=0,this.velocityX=0,this.velocityY=0,this.animate=!1,this.update_fn=this.update.bind(this),this.swipe_interval=null,this.swipe_fn=this.swipeAnimation.bind(this),this.setupTracking()}var s,i,r;return s=t,(i=[{key:"setupTracking",value:function(){var t=this;Ot.addGesture(new a.Track(this.element,(function(e){switch(e.phase){case"start":t.animate=!0,window.requestAnimationFrame(t.update_fn),clearInterval(t.swipe_interval);break;case"end":0==e.active.length&&(t.animate=!1)}}),{phases:["start","end"]}))}},{key:"randomBackground",value:function(){var t=kt(),e=kt(),s=kt();this.element.style.backgroundColor="rgb(".concat(t,", ").concat(e,", ").concat(s,")")}},{key:"addTap",value:function(t){var e=this;return Ot.addGesture(new a.Tap(this.element,(function(){e.randomBackground()}),t)),this}},{key:"addPress",value:function(t){var e=this;return Ot.addGesture(new a.Press(this.element,(function(){e.randomBackground()}),t)),this}},{key:"addRotate",value:function(t){var e=this;return Ot.addGesture(new a.Rotate(this.element,(function(t){e.rotation+=t.rotation}),t)),this}},{key:"addPan",value:function(t){var e=this;return Ot.addGesture(new a.Pan(this.element,(function(t){e.x+=t.translation.x,e.y+=t.translation.y}),t)),this}},{key:"addSwipe",value:function(t){var e=this;return Ot.addGesture(new a.Swipe(this.element,(function(t){var s=t.velocity>7?7:t.velocity;e.velocityX=s*Math.cos(t.direction)*7,e.velocityY=s*Math.sin(t.direction)*7,e.swipe_interval=setInterval(e.swipe_fn,1e3/60)}),t)),this}},{key:"addSwivel",value:function(t){var s=this;return Ot.addGesture(new a.Swivel(this.element,(function(t){s.rotation+=t.rotation}),e({pivotCenter:this.element},t))),this}},{key:"addPinch",value:function(t){var e=this;return Ot.addGesture(new a.Pinch(this.element,(function(t){e.scale*=t.scale}),t)),this}},{key:"addPull",value:function(t){var s=this;return Ot.addGesture(new a.Pull(this.element,(function(t){s.scale*=t.scale}),e({pivotCenter:this.element},t))),this}},{key:"update",value:function(){var t="rotate(".concat(this.rotation,"rad) "),e="translate(".concat(this.x,"px, ").concat(this.y,"px) "),s="scale(".concat(this.scale,") ");this.element.style.transform=e+t+s,this.animate&&window.requestAnimationFrame(this.update_fn)}},{key:"swipeAnimation",value:function(){this.x+=this.velocityX,this.y+=this.velocityY,this.velocityX=It(this.velocityX),this.velocityY=It(this.velocityY),0===this.velocityY&&0===this.velocityX&&clearInterval(this.swipe_interval),window.requestAnimationFrame(this.update_fn)}}])&&n(s.prototype,i),r&&n(s,r),t}(),jt=Math.floor(30),zt=[],Ct=0;Ct<12;Ct++){var Nt=jt*Ct;zt.push("hsl(".concat(Nt,", 100%, 75%)"))}var Rt=0;function Ft(){return zt[Rt++]}new Lt("TAP",Ft()).addTap(),new Lt("PAN",Ft()).addPan(),new Lt("PINCH",Ft()).addPinch(),new Lt("ROTATE",Ft()).addRotate(),new Lt("SWIPE",Ft()).addSwipe(),new Lt("PRESS",Ft()).addPress(),new Lt("SWIVEL",Ft()).addSwivel(),new Lt("PULL",Ft()).addPull(),new Lt("TAP, PAN, PINCH, SWIPE, and ROTATE\n(desktop: CTRL to SWIVEL and PULL)",Ft()).addTap().addPan({disableKeys:["ctrlKey"]}).addPinch().addRotate().addSwipe().addSwivel({enableKeys:["ctrlKey"]}).addPull({enableKeys:["ctrlKey"]}),new Lt("DOUBLE TAP",Ft()).addTap({numTaps:2}),new Lt("FIVE TAPS",Ft()).addTap({maxDelay:1e3,numTaps:5}),new Lt("SLOW TAP",Ft()).addTap({minDelay:300,maxDelay:1e3})}();
//# sourceMappingURL=sample.js.map
